{"version":3,"file":"authMiddleware.js","sources":["middlewares/authMiddleware.ts"],"sourceRoot":"/","sourcesContent":["import { Request, Response, NextFunction } from \"express\";\nimport jwt from \"jsonwebtoken\";\nimport env from \"../config/env\";\nimport AppError from \"../utils/appError\";\n\ninterface AuthenticatedRequest extends Request {\n  user?: string | jwt.JwtPayload; \n}\n\nexport const protect = (\n  req: AuthenticatedRequest,\n  res: Response,\n  next: NextFunction\n) => {\n  const token = extractTokenFromHeader(req);\n\n  if (!token) {\n    return next(new AppError(\"Unauthorized access\", 401));\n  }\n\n  try {\n    const decoded = jwt.verify(token, env.JWT_SECRET) as jwt.JwtPayload;\n    req.user = decoded;\n    next();\n  } catch (error) {\n    return next(new AppError(\"Invalid token\", 401));\n  }\n};\n\n/**\n * Extracts JWT token from Authorization header\n * @param req Express request object\n * @returns JWT token string or undefined\n */\nconst extractTokenFromHeader = (req: AuthenticatedRequest): string | undefined => {\n  const authHeader = req.headers.authorization;\n\n  if (authHeader && authHeader.startsWith(\"Bearer \")) {\n    return authHeader.split(\" \")[1];\n  }\n\n  return undefined;\n};\n"],"names":[],"mappings":";;;;;;;;AACA,gEAA+B;AAC/B,wDAAgC;AAChC,iEAAyC;AAMlC,MAAM,OAAO,GAAG,CACrB,GAAyB,EACzB,GAAa,EACb,IAAkB,EAClB,EAAE;IACF,MAAM,KAAK,GAAG,sBAAsB,CAAC,GAAG,CAAC,CAAC;IAE1C,IAAI,CAAC,KAAK,EAAE,CAAC;QACX,OAAO,IAAI,CAAC,IAAI,kBAAQ,CAAC,qBAAqB,EAAE,GAAG,CAAC,CAAC,CAAC;IACxD,CAAC;IAED,IAAI,CAAC;QACH,MAAM,OAAO,GAAG,sBAAG,CAAC,MAAM,CAAC,KAAK,EAAE,aAAG,CAAC,UAAU,CAAmB,CAAC;QACpE,GAAG,CAAC,IAAI,GAAG,OAAO,CAAC;QACnB,IAAI,EAAE,CAAC;IACT,CAAC;IAAC,OAAO,KAAK,EAAE,CAAC;QACf,OAAO,IAAI,CAAC,IAAI,kBAAQ,CAAC,eAAe,EAAE,GAAG,CAAC,CAAC,CAAC;IAClD,CAAC;AACH,CAAC,CAAC;AAlBW,QAAA,OAAO,WAkBlB;AAEF;;;;GAIG;AACH,MAAM,sBAAsB,GAAG,CAAC,GAAyB,EAAsB,EAAE;IAC/E,MAAM,UAAU,GAAG,GAAG,CAAC,OAAO,CAAC,aAAa,CAAC;IAE7C,IAAI,UAAU,IAAI,UAAU,CAAC,UAAU,CAAC,SAAS,CAAC,EAAE,CAAC;QACnD,OAAO,UAAU,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;IAClC,CAAC;IAED,OAAO,SAAS,CAAC;AACnB,CAAC,CAAC","debug_id":"97f22671-66e1-5514-ab5c-9ad6f9097d85"}