{"version":3,"file":"userRepository.js","sources":["repositories/userRepository.ts"],"sourceRoot":"/","sourcesContent":["import User, { IUser } from \"../models/userModel\";\nimport AppError from \"../utils/appError\";\n\nconst createUser = async (userData: Partial<IUser>) => {\n  const user = new User(userData);\n  await user.save();\n  return user;\n};\n\nconst findUserByEmail = async (email: string): Promise<IUser | null> => {\n  return User.findOne({ email });\n};\n\nconst findUserById = async (id: string): Promise<IUser | null> => {\n  return User.findById(id);\n};\n\nconst findUsers = async (\n  filter: any,\n  sort: any,\n  limit: number,\n  skip: number\n) => {\n  return User.find(filter).sort(sort).limit(limit).skip(skip);\n};\n\nconst updateUser = async (id: string, updateData: Partial<IUser>) => {\n  const user = await User.findByIdAndUpdate(id, updateData, { new: true });\n  if (!user) throw new AppError(\"User not found\", 404);\n  return user;\n};\n\nconst deleteUser = async (id: string) => {\n  const user = await User.findByIdAndDelete(id);\n  if (!user) throw new AppError(\"User not found\", 404);\n  return user;\n};\n\nconst setResetPasswordToken = async (\n  id: string,\n  token: string,\n  expires: Date\n) => {\n  const user = await User.findById(id);\n  if (!user) throw new AppError(\"User not found\", 404);\n  user.resetPasswordToken = token;\n  user.resetPasswordExpires = expires;\n  await user.save();\n  return user;\n};\n\nconst findByResetPasswordToken = async (\n  token: string\n): Promise<IUser | null> => {\n  return User.findOne({\n    resetPasswordToken: token,\n    resetPasswordExpires: { $gt: new Date() },\n  });\n};\n\nconst setRefreshToken = async (id: string, refreshToken: string) => {\n  const user = await User.findById(id);\n  if (!user) throw new AppError(\"User not found\", 404);\n  user.refreshToken = refreshToken;\n  await user.save();\n  return user;\n};\n\nconst removeRefreshToken = async (id: string) => {\n  const user = await User.findById(id);\n  if (!user) throw new AppError(\"User not found\", 404);\n  user.refreshToken = undefined;\n  await user.save();\n  return user;\n};\n\nexport default {\n  createUser,\n  findUserByEmail,\n  findUserById,\n  findUsers,\n  updateUser,\n  deleteUser,\n  setResetPasswordToken,\n  findByResetPasswordToken,\n  setRefreshToken,\n  removeRefreshToken,\n};\n"],"names":[],"mappings":"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","debug_id":"b4bede6f-51f1-53a7-bb60-ac603bd6db28"}