{"version":3,"file":"bookRepository.js","sources":["repositories/bookRepository.ts"],"sourceRoot":"/","sourcesContent":["import { Types } from \"mongoose\";\nimport Book, { IBook } from \"../models/bookModel\";\n\nexport const createBook = async (bookData: Partial<IBook>): Promise<IBook> => {\n  const book = new Book(bookData);\n  return book.save();\n};\n\nexport const findBookById = async (id: Types.ObjectId): Promise<IBook | null> =>\n  Book.findById(id).populate(\"author publisher genre reviews\").exec();\n\nexport const findAllBooks = async (\n  queryParams: any\n): Promise<{ books: IBook[]; total: number }> => {\n  const { sort, limit, page, ...filters } = queryParams;\n\n  const sortOptions = sort ? sort.split(\",\").join(\" \") : \"title\";\n  const limitValue = limit ? parseInt(limit, 10) : 10;\n  const skipValue = page ? (parseInt(page, 10) - 1) * limitValue : 0;\n\n  const booksQuery = Book.find(filters).populate(\n    \"author publisher genre reviews\"\n  );\n  const books = await booksQuery\n    .sort(sortOptions)\n    .skip(skipValue)\n    .limit(limitValue)\n    .exec();\n  const total = await Book.countDocuments(filters).exec();\n\n  return { books, total };\n};\n\nexport const updateBookById = async (\n  id: Types.ObjectId,\n  bookData: Partial<IBook>\n): Promise<IBook | null> =>\n  Book.findByIdAndUpdate(id, bookData, { new: true }).exec();\n\nexport const deleteBookById = async (\n  id: Types.ObjectId\n): Promise<IBook | null> => Book.findByIdAndDelete(id).exec();\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA,oEAAkD;AAE3C,MAAM,UAAU,GAAG,CAAO,QAAwB,EAAkB,EAAE;IAC3E,MAAM,IAAI,GAAG,IAAI,mBAAI,CAAC,QAAQ,CAAC,CAAC;IAChC,OAAO,IAAI,CAAC,IAAI,EAAE,CAAC;AACrB,CAAC,CAAA,CAAC;AAHW,QAAA,UAAU,cAGrB;AAEK,MAAM,YAAY,GAAG,CAAO,EAAkB,EAAyB,EAAE,kDAC9E,OAAA,mBAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,QAAQ,CAAC,gCAAgC,CAAC,CAAC,IAAI,EAAE,CAAA,GAAA,CAAC;AADzD,QAAA,YAAY,gBAC6C;AAE/D,MAAM,YAAY,GAAG,CAC1B,WAAgB,EAC4B,EAAE;IAC9C,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,KAAiB,WAAW,EAAvB,OAAO,UAAK,WAAW,EAA/C,yBAAiC,CAAc,CAAC;IAEtD,MAAM,WAAW,GAAG,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC;IAC/D,MAAM,UAAU,GAAG,KAAK,CAAC,CAAC,CAAC,QAAQ,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;IACpD,MAAM,SAAS,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC,IAAI,EAAE,EAAE,CAAC,GAAG,CAAC,CAAC,GAAG,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;IAEnE,MAAM,UAAU,GAAG,mBAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,QAAQ,CAC5C,gCAAgC,CACjC,CAAC;IACF,MAAM,KAAK,GAAG,MAAM,UAAU;SAC3B,IAAI,CAAC,WAAW,CAAC;SACjB,IAAI,CAAC,SAAS,CAAC;SACf,KAAK,CAAC,UAAU,CAAC;SACjB,IAAI,EAAE,CAAC;IACV,MAAM,KAAK,GAAG,MAAM,mBAAI,CAAC,cAAc,CAAC,OAAO,CAAC,CAAC,IAAI,EAAE,CAAC;IAExD,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC;AAC1B,CAAC,CAAA,CAAC;AApBW,QAAA,YAAY,gBAoBvB;AAEK,MAAM,cAAc,GAAG,CAC5B,EAAkB,EAClB,QAAwB,EACD,EAAE,kDACzB,OAAA,mBAAI,CAAC,iBAAiB,CAAC,EAAE,EAAE,QAAQ,EAAE,EAAE,GAAG,EAAE,IAAI,EAAE,CAAC,CAAC,IAAI,EAAE,CAAA,GAAA,CAAC;AAJhD,QAAA,cAAc,kBAIkC;AAEtD,MAAM,cAAc,GAAG,CAC5B,EAAkB,EACK,EAAE,kDAAC,OAAA,mBAAI,CAAC,iBAAiB,CAAC,EAAE,CAAC,CAAC,IAAI,EAAE,CAAA,GAAA,CAAC;AAFjD,QAAA,cAAc,kBAEmC","debug_id":"da5708cb-e4c0-5e4c-9778-025803823be2"}